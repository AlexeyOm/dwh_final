Проектная работа по модулю “DWH”

Для корректной работы sql скрипта данные должны храниться в схеме booking, в ней же будут созданы таблицы fact_fligts с фактами и таблицы размерностей: 
dim_calendar - справочник дат;
dim_passengers - справочник пассажиров;
dim_aircrafts - справочник самолетов;
dim_airports - справочник аэропортов;
dim_tariff - справочник тарифов.

Особенности создания и заполнения измерения календарь
Справочник календарь заполняется в следующем порядке:
- создаётся таблица dim_calendar;
- трансформация load_calendar генерирует дни, добавляет к ним выходные и праздники из прозводственного календаря из API https://isdayoff.ru/api/getdata?year=XXXX&delimeter=/, гдe XXXX - год
- скриптом дозаполняются дни недели, номера недели в году и рабочие дни

DATA QUALITY

При заливке справочника самолётов dim_aircrafts реализованы следующие проверки:
- код IATA не пуст;
- указана модель самолёта;
- расстояние полёта положительно.
Не прошедшие проверки строки заливаются в файл aircraft_errors.csv для дальнейшего ручного разбора

При заливке справочника пассажиров dim_passengers реализованы следующие проверки:
- удостоверение личности не пусто;
- имя пассажира не пусто;
- указан хотя бы один способ связаться с пассажиром (email или телефон).
Не прошедшие проверки строки заливаются в файл pax_errors.csv для дальнейшего ручного разбора

При заливке справочника пассажиров dim_aerports реализованы следующие проверки:
- временная зона не пуста;
- название аэропорта не пусто;
- широта и долгота в пределах земного шара.
Не прошедшие проверки строки заливаются в файл airports_errors.csv для дальнейшего ручного разбора

При заливке справочника тарифов dim_tariff реализованы следующие проверки:
- название тарифа не пусто
Не прошедшие проверки строки заливаются в файл tariff_errors.csv для дальнейшего ручного разбора

